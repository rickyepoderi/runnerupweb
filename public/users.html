<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RunnerUpWeb User Management</title>
    <link rel="stylesheet" href="resources/css/runnerupweb.css">
    <script src="resources/js/jquery-2.1.4.min.js" type="text/javascript"></script>
    <script src="resources/js/runnerupweb.js" type="text/javascript"></script>
    <script type="text/javascript">
      var opts;
      var userList;
      var user;
        
      function onLoad() {
          user = new UserInfo('', true, null);
          new UserOption(createUserList);
      }
  
      function createUserList(userOptions) {
          // read or create new activity list to show
          // opts are created
          opts = userOptions;
          opts.setBackgroundImage();
          userList = new UserList(printSearch, opts);
          userList.search();
      }
      
      function printSearch(startrow) {
          for (var i = startrow; i < userList.users.length; i++) {
              var row = $('<tr>');
              var style = (((parseInt(i) + 1) % this.page) === 0) ? " class='lastrow'" : "";
              row.append('<td' + style + '>' + this.users[i].login + '</td>');
              row.append('<td' + style + '>' + ((this.users[i].firstname)? this.users[i].firstname:'&nbsp;') + '</td>');
              row.append('<td' + style + '>' + ((this.users[i].lastname)? this.users[i].lastname:'&nbsp;') + '</td>');
              row.append('<td' + style + '>' + ((this.users[i].email)? this.users[i].email:'&nbsp;') + '</td>');
              row.append($('<input>', {'type': 'hidden', 'value': this.users[i].login}));
              row.click(function () {
                  var id = $(this).find("input[type=hidden]").attr("value");
                  if (id) {
                      $(location).attr('href', 'user.html?login=' + id);
                  }
              });
              $('#user-table').find('tbody').append(row);
          }
          $('#size').html(userList.users.length);
          if (userList.moredata) {
              $('#moredata').html('More Data');
              $('#moredata').click(this.moreSearch.bind(this));
              $('#moredata').css( 'cursor', 'pointer' );
          } else {
              $('#moredata').html('&nbsp;');
              $('#moredata').unbind('click');
              $('#moredata').css( 'cursor', 'default' );
          }
      }
        
    </script>
</head>
<body onload="onLoad()">
    <div class="main">
        <div class="header">
            <div id="div-menu" class="menu" onclick="showPopupMenu(user)"></div>
            <h1 id="period-name">User Management</h1>
            <p class="left">
                Displaying <span id="size"></span> users. <a href="user.html?op=create">Create new user</a>.
            </p>
        </div>
        <table id="user-table">
            <thead>
                <tr>
                    <th>Login</th>
                    <th>Firstname</th>
                    <th>Lastname</th>
                    <th>email</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
    <div id="moredata" class="footer">More Data</div>    
</body>
</html>
